<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>automagicA11y – Tooltip Example</title>
  <link rel="stylesheet" href="./styles.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css">
</head>
<body>
  <main>
    <h1>Tooltip</h1>
    <p>
      Tooltips show contextual information on hover or focus without any imperative wiring. They share the same class grammar as other patterns, so styling stays declarative.
    </p>

    <section class="card">
      <h2 id="forecast-heading">Daily forecast</h2>
      <p>Hover or focus the button to read the screen-friendly summary.</p>

      <div class="tooltip-wrapper" aria-labelledby="forecast-heading">
        <button
          class="btn"
          data-automagica11y-tooltip="#tip-forecast"
          data-automagica11y-trigger-class-active="is-armed"
          data-automagica11y-target-class-open="tooltip-bubble--visible">
          Show forecast
        </button>
        <span id="tip-forecast" class="tooltip-bubble" role="tooltip" hidden>
          Expect scattered showers in the afternoon. Umbrellas recommended after 2&nbsp;PM.
        </span>
      </div>
    </section>

    <section class="card">
      <h2 id="field-heading">Form hint</h2>
      <p>
        Tooltips pair well with form labels. Focus stays on the field while assistive tech gets additional context through <code>aria-describedby</code>.
      </p>
      <label for="email">Work email</label>
      <div class="tooltip-field">
        <input id="email" type="email" class="field" placeholder="name@example.com" />
        <div class="tooltip-wrapper">
          <button
            class="btn"
            type="button"
            aria-label="Why do we need your work email?"
            data-automagica11y-tooltip="#tip-email"
            data-automagica11y-target-class-open="tooltip-bubble--visible">
            ℹ️
          </button>
          <span id="tip-email" class="tooltip-bubble" role="tooltip" hidden>
            We use your work address to connect you with enterprise-specific features and onboarding.
          </span>
        </div>
      </div>
    </section>

    <section class="card">
      <h2 id="hooks-heading">Lifecycle hooks</h2>
      <p>
        Tooltips emit <code>automagica11y:tooltip:* </code> events so you can attach analytics, announcements, or custom logic.
        Try interacting with the sample trigger and watch the log update.
      </p>

      <div class="tooltip-wrapper" aria-labelledby="hooks-heading">
        <button
          class="btn"
          type="button"
          data-automagica11y-tooltip="#tip-hooks"
          data-automagica11y-trigger-class-active="is-armed"
          data-automagica11y-target-class-open="tooltip-bubble--visible">
          Inspect lifecycle
        </button>
        <span id="tip-hooks" class="tooltip-bubble" role="tooltip" hidden>
          These events bubble: <code>tooltip:ready</code>, <code>tooltip:shown</code>, <code>tooltip:hidden</code>.
        </span>
      </div>

      <div class="log" aria-live="polite">
        <p class="log__title">Event log</p>
        <ul id="tooltip-log"></ul>
      </div>
    </section>

    <section class="card">
      <h2>Implementation</h2>
      <p>Reference the tooltip element via <code>data-automagica11y-tooltip</code> and optionally define class hooks for open/closed states.</p>

      <pre><code class="language-html">&lt;div class="tooltip-wrapper">
  &lt;button
    data-automagica11y-tooltip="#tip-forecast"
    data-automagica11y-trigger-class-active="is-armed"
    data-automagica11y-target-class-open="tooltip-bubble--visible">
    Show forecast
  &lt;/button>
  &lt;span id="tip-forecast" class="tooltip-bubble" role="tooltip" hidden>
    Expect scattered showers...
  &lt;/span>
&lt;/div></code></pre>

      <p>Include the compiled bundle (or import the library) once to register the tooltip pattern.</p>

      <pre><code class="language-html">&lt;script src="../dist/automagica11y.min.js">&lt;/script></code></pre>
    </section>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markup.min.js"></script>
  <script src="../dist/automagica11y.min.js"></script>
  <script>
    const logList = document.getElementById("tooltip-log");
    const appendLog = (message) => {
      if (!logList) return;
      const item = document.createElement("li");
      const time = new Date().toLocaleTimeString();
      item.textContent = `[${time}] ${message}`;
      logList.prepend(item);
      const entries = Array.from(logList.children);
      entries.slice(5).forEach((node) => node.remove());
    };

    document.addEventListener("automagica11y:tooltip:ready", (event) => {
      const id = event.detail.target.id;
      appendLog(`Tooltip #${id} ready`);
    });

    document.addEventListener("automagica11y:tooltip:shown", (event) => {
      appendLog(`Shown: #${event.detail.target.id}`);
    });

    document.addEventListener("automagica11y:tooltip:hidden", (event) => {
      appendLog(`Hidden: #${event.detail.target.id}`);
    });
  </script>
</body>
</html>
